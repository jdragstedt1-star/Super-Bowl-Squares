
        document.addEventListener('DOMContentLoaded', function() {
            // Listen for changes from Firebase
            gameRef.on('value', (snapshot) => {
                const data = snapshot.val();
                if (data) {
                    // Update local state from Firebase
                    if (data.grid) {
                        grid = data.grid;
                    }
                    if (data.team1Numbers) {
                        team1Numbers = data.team1Numbers;
                    }
                    if (data.team2Numbers) {
                        team2Numbers = data.team2Numbers;
                    }
                    if (data.quarterScores) {
                        quarterScores = data.quarterScores;
                    }
                    if (data.team1Name) {
                        document.getElementById('team1Name').value = data.team1Name;
                    }
                    if (data.team2Name) {
                        document.getElementById('team2Name').value = data.team2Name;
                    }
                    
                    // Update UI
                    initGrid();
                    if (!isInitialLoad) {
                        // Update current quarter display
                        const currentQ = data.currentQuarter || currentQuarter;
                        if (currentQ !== currentQuarter) {
                            selectQuarter(currentQ);
                        } else {
                            document.getElementById('team1Score').value = quarterScores[currentQuarter].team1;
                            document.getElementById('team2Score').value = quarterScores[currentQuarter].team2;
                            updateWinner();
                        }
                    }
                    isInitialLoad = false;
                } else {
                    // No data in Firebase - initialize with default numbers
                    if (team1Numbers.length === 0) {
                        randomizeNumbers();
                    }
                    initGrid();
                    isInitialLoad = false;
                }
            });

            // Initialize the grid
            initGrid();

            // Set up event listeners
            document.getElementById('nameInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    claimSquare();
                }
            });

            document.getElementById('team1Name').addEventListener('input', () => {
                updateTeamLabels();
                saveToFirebase();
            });
            
            document.getElementById('team2Name').addEventListener('input', () => {
                updateTeamLabels();
                saveToFirebase();
            });
        });